import * as React from "react"
import { addPropertyControls, ControlType, Color, motion } from "framer"
import * as FeatherIcons from "react-feather"

/*
 ** ICON
 ** - Add other icon libraries if it doesn't impact bundle size too much
 ** - make this a custom component with full icons and such
 */

export interface IconProps {
    width: number
    height: number
    color?: Color
    selection?: boolean
    iconSearch?: string
    iconSelection?: string
    onTap?: any
    onClick?: any
    onMouseEnter?: any
    onMouseLeave?: any
}

export function Icon({
    width,
    height,
    color,
    selection,
    iconSearch,
    iconSelection,
    onTap,
    onClick,
    onMouseEnter,
    onMouseLeave,
}: IconProps) {
    const iconSearchTerm = iconSearch ? iconSearch : "Framer"
    const name = selection
        ? iconSelection
        : iconSearchTerm
              .toLowerCase()
              .split("-")
              .map(piece => piece.charAt(0).toUpperCase() + piece.slice(1))
              .join("")

    const TagName = FeatherIcons[name]

    return TagName ? (
        <TagName icon={name} width={width} height={height} color={color} />
    ) : (
        <Framer />
    )
}

function Framer() {
    return (
        <motion.div
            style={tabHelperContainer}
            {...{ onTap, onClick, onMouseEnter, onMouseLeave }}
        >
            <svg
                xmlns="http://www.w3.org/2000/svg"
                viewBox="0 0 30 30"
                style={iconStyle}
            >
                <path
                    d="M 12.857 0 C 19.958 0 25.714 5.756 25.714 12.857 C 25.714 19.958 19.958 25.714 12.857 25.714 C 5.756 25.714 0 19.958 0 12.857 C 0 5.756 5.756 0 12.857 0 Z"
                    fill="#FFFFFF"
                ></path>
                <path
                    d="M 20.357 20.357 L 27.857 27.857"
                    fill="transparent"
                    stroke-width="4.28"
                    stroke="#FFFFFF"
                    stroke-linecap="round"
                ></path>
                <g transform="translate(9.643 6.429)">
                    <path
                        d="M 3.214 12.857 L 3.214 12.857"
                        fill="transparent"
                        stroke-width="3.75"
                        stroke="#8A58FF"
                        stroke-linecap="round"
                    ></path>
                    <path
                        d="M 0 3.214 C 0 1.004 1.843 0 3.214 0 C 4.586 0 6.429 0.603 6.429 3.214 C 6.429 5.826 3.214 5.913 3.214 7.232 C 3.214 8.552 3.214 8.571 3.214 8.571"
                        fill="transparent"
                        stroke-width="3.22"
                        stroke="#8A58FF"
                        stroke-linecap="round"
                        stroke-linejoin="round"
                    ></path>
                </g>
            </svg>
        </motion.div>
    )
}

Icon.defaultProps = {
    width: 48,
    height: 48,
    iconSelection: "Framer",
    iconSearch: "Framer",
    color: "#000",
    selection: true,
}

// @ts-ignore
addPropertyControls(Icon, {
    color: { type: ControlType.Color, title: "Color" },
    selection: {
        type: ControlType.Boolean,
        title: "Find icon…",
        enabledTitle: "Choose",
        disabledTitle: "Search",
    },
    iconSelection: {
        type: ControlType.Enum,
        options: Object.keys(FeatherIcons),
        defaultValue: Icon.defaultProps.iconSelection,
        title: "Icon",
        hidden: ({ selection }) => !selection,
    },
    iconSearch: {
        type: ControlType.String,
        title: "Icon",
        placeholder: "Menu, Wifi, Box…",
        hidden: ({ selection }) => selection,
    },
    onTap: {
        type: ControlType.EventHandler,
    },
    onClick: {
        type: ControlType.EventHandler,
    },
    onMouseEnter: {
        type: ControlType.EventHandler,
    },
    onMouseLeave: {
        type: ControlType.EventHandler,
    },
})

const tabHelperContainer: React.CSSProperties = {
    width: "100%",
    height: "100%",
    borderRadius: 6,
    background: "rgba(136, 85, 255, 0.3)",
    border: "1px dashed #85F",
    display: "flex",
    flexDirection: "column",
    justifyContent: "center",
    alignItems: "center",
}

const iconStyle: React.CSSProperties = {
    minWidth: "10px",
    minHeight: "10px",
    maxWidth: "20px",
    maxHeight: "20px",
    width: "60%",
    height: "60%",
}
